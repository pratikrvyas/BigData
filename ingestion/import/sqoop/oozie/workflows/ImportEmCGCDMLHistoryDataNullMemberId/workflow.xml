<workflow-app name="ImportSkywardsDataNullMemberId-Naveen" xmlns="uri:oozie:workflow:0.5">
    <start to="shell-b9b2"/>
    <kill name="Kill">
        <message>Action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>
    </kill>
    <action name="shell-b9b2">
        <shell xmlns="uri:oozie:shell-action:0.1">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <exec>helix_donothing.sh</exec>
            <file>helix_donothing.sh#helix_donothing.sh</file>
              <capture-output/>
        </shell>
        <ok to="sqoop-2606"/>
        <error to="Kill"/>
    </action>
    <action name="sqoop-2606">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--query</arg>
              <arg>&quot;SELECT MEMBER_ID,MEMBERSHIP_TYPE,GROUPING_NO,JOIN_DATE,WMEM_USR_CREATED,WMEM_CREATED,PREFERRED_CARD_NAME,ACTIVE_STATUS,SKYWARDS_MILES_BAL,ORG_ORG_ID,MERGD_FROM_MEMBER_ID,MEM_MEMBER_ID,ASSOCIATED_MEMBER_ID,RECOM_BY_MEMBER_ID,DEPARTMENT_NAME,TERMINATION_DATE,NON_EXP_END,UPGRADE_PROHIBITED,DOWNGRADE_PROHIBITED,POSTAL_STATUS,LAST_DNGRD_RVW_DATE,VS_YIELD_VALUE,VS_LAST_ACTVTY_DATE,NOTES,ACTIVE_CARD_NO,LAST_EXPIRY,RECEIVED_BONUS_AWRD,WELCOME_LETTER_DATE,WMEM_USR_CHANGED,AUTHORISED_SIGNATORY,WMEM_CHANGED,INTY_CODE,TIER_MILES_BAL,OTHER_MEMBER_ID,RLTNSHIP_TO_FAM_HEAD,AGENT_CODE,AUTH_SIGN_RELATION,PROSP_COMM_CODE,POSTAL_STAT_CHNG_RSN,WMEM_STG_PROCESS_DATE,RULE_CODE,CONDITION_MET_DATE,FAMILY_ID,HEAD_SHARE_PERCENT,MEMBER_SHARE_PERCENT,MGM_REQUEST,MEDIA_TYPE,MEDIA_CODE,PARTNER_CODE,ECMC_DESCR,ENROL_METHOD_CODE,ENROL_METHOD_DSCR,TIER_CODE,TIER_TYPE,SEQUENCE_NUMBER,TIER_DESCRIPTION,CARD_NO_PREFIX,TIER_RESOLUTION_CODE,TERRITORY_CODE,AMC_CODE,TERRITORY_DSCR,MTC_TRAVEL_COORD_ID,MTC_RELATIONSHIP,MTC_CO_NAME,MTC_TELEPHONE_NO_HOME,MTC_TELEPHONE_NO_WORK,MTC_MOBILE_NO,MTC_EMAIL_ADDRESS,MTC_JOB_ROLE,MTC_INTERNET_ACCESS,MTC_FAX_NO,PERSON_ID,IMPORTANCE_RATING,LASTNAME_UPPER,FIRSTNAME,INITIALS,TITLE,GENDER,NATIONALITY_CODE,DATE_OF_BIRTH,INTERNET_USER_NAME,SEND_NO_EMAIL,ACC_ONLINE_STATUS,ACC_ONLINE_STAT_DATE,SEND_VS_MAIL,SEND_NON_VS_MAIL,WPER_USR_CREATED,WPER_CREATED,WPER_USR_CHANGED,WPER_CHANGED,FAMILY_NAME,NO_FAMILY_MEMBERS,JOB_DESIGNATION,INT_CODE,STAFF_NO,JOB_TITLE,UNSUBSCRIBE_EMAIL,INVALID_EMAIL,EMAIL_ADDRESS_UPPER,WPER_STG_PROCESS_DATE,PCO_CODE,PCO_DESCR,IND_TYPE_CODE,IND_TYPE_DESCR,LANGUAGE_ID,LANGUAGE_NAME,LANGUAGE_RES_CODE,SDW_CREATED_DATE,SDW_CHANGED_DATE,SDW_REFRESH_DATE,ADDRESS_TYPE_CODE,ADDRESS_ID,VALID_FROM_DATE,VALID_TO_DATE,PREFFERED_CONTACT,COUNTRY_IATA_CODE,COUNTRY_NAME,AT_CODE,ISD_CODE,STREET,TOWN,BUILDING,LOCALITY,REGION,POST_CODE,PO_BOX,REGION_CODE,CTY_IATA_CODE,SOF_CODE,SEND_CARE_OF,CITY_NAME,INVALID_ADDRESS,EMAIL_ADDRESS,MIME_PREFERENCE,STAT_PREFERENCE,CHECK_INVALID_EMAIL,FORMAL_SAL,FAMILY_HEAD_ID,COMPANY_NAME,FAMILY_HEAD_FLAG,FAMILY_MEMBER_FLAG,EMAIL_ADDRESS_LOWER,NEXT_EXPIRING_MILES,NEXT_EXPIRY_DATE,FEEDBACK_CATEGORY,ES_DOWNLOAD_STATUS,NCC_CODE,COUNTRY_CORP_ENABLE,MOB_IND,EUB_ID,BR_MEMBER_FLAG,SECONDARY_FAM_HEAD,AGE,TMB_CHANGED_DATE,LAST_ACTIVITY_F,LAST_ACTIVITY_J,LAST_ACTIVITY_Y,LASTEST_ACTIVITY_DATE,COMPANY_NAME_CLEANED,INDUSTRY_TYPE_CLEANED,HOME_AIRPORT,PARENT_CARD_NO,COBRAND_MEMBER,ALT_EMAIL_ADDRESS_UPPER,ALT_EMAIL_ADDRESS,PROFILE_COMPL_PERC,JOIN_FAM_DATE,AGENT_MODIFY_CODE,PRS_CODE,PLASTIC_CARD,MINOR_STATUS_CHNG_REASON,TRAVEL_AGENT_ID,AGENT_PROMO_CODE,CHANNEL_ID,UPLOAD_ID FROM (SELECT T1.MEMBER_ID,T1.MEMBERSHIP_TYPE,T1.GROUPING_NO,T1.JOIN_DATE,T1.WMEM_USR_CREATED,T1.WMEM_CREATED,T1.PREFERRED_CARD_NAME,T1.ACTIVE_STATUS,T1.SKYWARDS_MILES_BAL,T1.ORG_ORG_ID,T1.MERGD_FROM_MEMBER_ID,T1.MEM_MEMBER_ID,T1.ASSOCIATED_MEMBER_ID,T1.RECOM_BY_MEMBER_ID,T1.DEPARTMENT_NAME,T1.TERMINATION_DATE,T1.NON_EXP_END,T1.UPGRADE_PROHIBITED,T1.DOWNGRADE_PROHIBITED,T1.POSTAL_STATUS,T1.LAST_DNGRD_RVW_DATE,T1.VS_YIELD_VALUE,T1.VS_LAST_ACTVTY_DATE,T1.NOTES,T1.ACTIVE_CARD_NO,T1.LAST_EXPIRY,T1.RECEIVED_BONUS_AWRD,T1.WELCOME_LETTER_DATE,T1.WMEM_USR_CHANGED,T1.AUTHORISED_SIGNATORY,T1.WMEM_CHANGED,T1.INTY_CODE,T1.TIER_MILES_BAL,T1.OTHER_MEMBER_ID,T1.RLTNSHIP_TO_FAM_HEAD,T1.AGENT_CODE,T1.AUTH_SIGN_RELATION,T1.PROSP_COMM_CODE,T1.POSTAL_STAT_CHNG_RSN,T1.WMEM_STG_PROCESS_DATE,T1.RULE_CODE,T1.CONDITION_MET_DATE,T1.FAMILY_ID,T1.HEAD_SHARE_PERCENT,T1.MEMBER_SHARE_PERCENT,T1.MGM_REQUEST,T1.MEDIA_TYPE,T1.MEDIA_CODE,T1.PARTNER_CODE,T1.ECMC_DESCR,T1.ENROL_METHOD_CODE,T1.ENROL_METHOD_DSCR,T1.TIER_CODE,T1.TIER_TYPE,T1.SEQUENCE_NUMBER,T1.TIER_DESCRIPTION,T1.CARD_NO_PREFIX,T1.TIER_RESOLUTION_CODE,T1.TERRITORY_CODE,T1.AMC_CODE,T1.TERRITORY_DSCR,T1.MTC_TRAVEL_COORD_ID,T1.MTC_RELATIONSHIP,T1.MTC_CO_NAME,T1.MTC_TELEPHONE_NO_HOME,T1.MTC_TELEPHONE_NO_WORK,T1.MTC_MOBILE_NO,T1.MTC_EMAIL_ADDRESS,T1.MTC_JOB_ROLE,T1.MTC_INTERNET_ACCESS,T1.MTC_FAX_NO,nvl2(T1.PERSON_ID,t1.person_id,-1) AS PERSON_ID,T1.IMPORTANCE_RATING,T1.LASTNAME_UPPER,T1.FIRSTNAME,T1.INITIALS,T1.TITLE,T1.GENDER,T1.NATIONALITY_CODE,T1.DATE_OF_BIRTH,T1.INTERNET_USER_NAME,T1.SEND_NO_EMAIL,T1.ACC_ONLINE_STATUS,T1.ACC_ONLINE_STAT_DATE,T1.SEND_VS_MAIL,T1.SEND_NON_VS_MAIL,T1.WPER_USR_CREATED,T1.WPER_CREATED,T1.WPER_USR_CHANGED,T1.WPER_CHANGED,T1.FAMILY_NAME,T1.NO_FAMILY_MEMBERS,T1.JOB_DESIGNATION,T1.INT_CODE,T1.STAFF_NO,T1.JOB_TITLE,T1.UNSUBSCRIBE_EMAIL,T1.INVALID_EMAIL,T1.EMAIL_ADDRESS_UPPER,T1.WPER_STG_PROCESS_DATE,T1.PCO_CODE,T1.PCO_DESCR,T1.IND_TYPE_CODE,T1.IND_TYPE_DESCR,T1.LANGUAGE_ID,T1.LANGUAGE_NAME,T1.LANGUAGE_RES_CODE,T1.SDW_CREATED_DATE,T1.SDW_CHANGED_DATE,T1.SDW_REFRESH_DATE,T1.ADDRESS_TYPE_CODE,T1.ADDRESS_ID,T1.VALID_FROM_DATE,T1.VALID_TO_DATE,T1.PREFFERED_CONTACT,T1.COUNTRY_IATA_CODE,T1.COUNTRY_NAME,T1.AT_CODE,T1.ISD_CODE,T1.STREET,T1.TOWN,T1.BUILDING,T1.LOCALITY,T1.REGION,T1.POST_CODE,T1.PO_BOX,T1.REGION_CODE,T1.CTY_IATA_CODE,T1.SOF_CODE,T1.SEND_CARE_OF,T1.CITY_NAME,T1.INVALID_ADDRESS,T1.EMAIL_ADDRESS,T1.MIME_PREFERENCE,T1.STAT_PREFERENCE,T1.CHECK_INVALID_EMAIL,T1.FORMAL_SAL,T1.FAMILY_HEAD_ID,T1.COMPANY_NAME,T1.FAMILY_HEAD_FLAG,T1.FAMILY_MEMBER_FLAG,T1.EMAIL_ADDRESS_LOWER,T1.NEXT_EXPIRING_MILES,T1.NEXT_EXPIRY_DATE,T1.FEEDBACK_CATEGORY,T1.ES_DOWNLOAD_STATUS,T1.NCC_CODE,T1.COUNTRY_CORP_ENABLE,T1.MOB_IND,T1.EUB_ID,T1.BR_MEMBER_FLAG,T1.SECONDARY_FAM_HEAD,T1.AGE,T1.TMB_CHANGED_DATE,T1.LAST_ACTIVITY_F,T1.LAST_ACTIVITY_J,T1.LAST_ACTIVITY_Y,T1.LASTEST_ACTIVITY_DATE,T1.COMPANY_NAME_CLEANED,T1.INDUSTRY_TYPE_CLEANED,T1.HOME_AIRPORT,T1.PARENT_CARD_NO,T1.COBRAND_MEMBER,T1.ALT_EMAIL_ADDRESS_UPPER,T1.ALT_EMAIL_ADDRESS,T1.PROFILE_COMPL_PERC,T1.JOIN_FAM_DATE,T1.AGENT_MODIFY_CODE,T1.PRS_CODE,T1.PLASTIC_CARD,T1.MINOR_STATUS_CHNG_REASON,T1.TRAVEL_AGENT_ID,T1.AGENT_PROMO_CODE,T1.CHANNEL_ID,T1.UPLOAD_ID FROM SDW_CUSTOMER T1 WHERE T1.MEMBER_ID IS NULL) T1 WHERE $CONDITIONS&quot;</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>JOIN_DATE=String,WMEM_CREATED=String,TERMINATION_DATE=String,NON_EXP_END=String,UPGRADE_PROHIBITED=String,DOWNGRADE_PROHIBITED=String,LAST_DNGRD_RVW_DATE=String,VS_LAST_ACTVTY_DATE=String,LAST_EXPIRY=String,WELCOME_LETTER_DATE=String,WMEM_CHANGED=String,WMEM_STG_PROCESS_DATE=String,CONDITION_MET_DATE=String,DATE_OF_BIRTH=String,ACC_ONLINE_STAT_DATE=String,WPER_CREATED=String,WPER_CHANGED=String,WPER_STG_PROCESS_DATE=String,NEXT_EXPIRY_DATE=String,SDW_CHANGED_DATE=String,VALID_FROM_DATE=String,SDW_REFRESH_DATE=String,LAST_ACTIVITY_Y=String,VALID_TO_DATE=String,SDW_CREATED_DATE=String,TMB_CHANGED_DATE=String,LAST_ACTIVITY_F=String,LAST_ACTIVITY_J=String,LASTEST_ACTIVITY_DATE=String,JOIN_FAM_DATE=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>T1.PERSON_ID</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SKY_SDW_CUSTOMER</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_CUSTOMER}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="End"/>
        <error to="email-f2b6"/>
    </action>
    <action name="email-f2b6">
        <email xmlns="uri:oozie:email-action:0.2">
            <to>naveen.k@dnata.com</to>
            <subject>Workflow ${wf:name()} failed</subject>
            <body>Current timestamp: ${timestamp()}
Workflow name: ${wf:name()}
Workflow id: ${wf:id()}
Workflow application path: ${wf:appPath()}
Workflow user: ${wf:user()}
Last error action: ${wf:lastErrorNode()}
Error code: ${wf:errorCode(wf:lastErrorNode())}
Error message: ${wf:errorMessage(wf:lastErrorNode())}
</body>
            <content_type>text/plain</content_type>
        </email>
        <ok to="End"/>
        <error to="Kill"/>
    </action>
    <end name="End"/>
</workflow-app>