<workflow-app name="ImportSkywardsData" xmlns="uri:oozie:workflow:0.5">
  <global>
            <configuration>
                <property>
                    <name>oozie.launcher.mapred.job.queue.name</name>
                    <value>ingest</value>
                </property>
                <property>
                    <name>mapred.job.queue.name</name>
                    <value>ingest</value>
                </property>
            </configuration>
  </global>
    <start to="shell-ddfb"/>
    <kill name="Kill">
        <message>Action failed, error message[${wf:errorMessage(wf:lastErrorNode())}]</message>
    </kill>
    <action name="shell-ddfb">
        <shell xmlns="uri:oozie:shell-action:0.1">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <exec>helix_current_date.sh</exec>
            <file>helix_current_date.sh#helix_current_date.sh</file>
              <capture-output/>
        </shell>
        <ok to="decision-5634"/>
        <error to="email-cb7f"/>
    </action>
    <action name="shell-ffb5">
        <shell xmlns="uri:oozie:shell-action:0.1">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <exec>helix_donothing.sh</exec>
            <file>helix_donothing.sh#helix_donothing.sh</file>
              <capture-output/>
        </shell>
        <ok to="End"/>
        <error to="email-cb7f"/>
    </action>
    <action name="sqoop-38e6">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_ALIAS_CARDS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_MEMBER_ALIAS_CARDS</arg>
              <arg>--columns</arg>
              <arg>PMP_MEM_UID,LPP_PTNR_CODE,ALIAS_CARD_NUMBER,USR_CREATED,CREATED,USR_CHANGED,CHANGED,MEMBERSHIP_PREFIX,ALN_CODE,PER_PERSON_ID,SEQ_NUMBER_PK,STG_PROCESS_DATE,SDW_CREATED_DATE,SDW_CHANGED_DATE,SDW_REFRESH_DATE,ALIAS_MBT_CODE,PARENT_CARD_NO</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>CREATED=String,CHANGED=String,STG_PROCESS_DATE=String,SDW_CREATED_DATE=String,SDW_CHANGED_DATE=String,SDW_REFRESH_DATE=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>SEQ_NUMBER_PK</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_MEMBER_ALIAS_CARDS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_ALIAS_CARDS}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <decision name="decision-5634">
        <switch>
            <case to="shell-ffb5">
              ${ (wf:actionData(&#39;shell-ddfb&#39;)[&#39;HELIX_RUN_IMPORT&#39;] eq &#39;FALSE&#39;) }
            </case>
            <case to="fork-0bc8">
              ${ (wf:actionData(&#39;shell-ddfb&#39;)[&#39;HELIX_RUN_IMPORT&#39;] eq &#39;TRUE&#39;) }
            </case>
            <default to="email-cb7f"/>
        </switch>
    </decision>
    <action name="sqoop-2151">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_MEMBERSHIP_TIERS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_MEMBERSHIP_TIERS</arg>
              <arg>--columns</arg>
              <arg>CODE,MBT_TYPE,USR_CREATED,CREATED,SEQ_NUMBER,CARD_REPLACE_PERIOD,DGRADE_REVIEW_PERIOD,UGRADE_REVIEW_PERIOD,EXP_REVIEW_INTERVAL,DESCR,CARD_NO_PREFIX,RETRO_CREDIT_PERIOD,QUICK_MVMT_PERIOD,USR_CHANGED,CHANGED,IMAGE_FILENAME,EXP_REVIEW_RND_INTERVAL,CARD_REPLACE_RND_INTERVAL,REDEMPTION_OVERDRAFT_LIMIT,MBT_RES_CODE,REVIEW_LAG_DAYS,TIER_MILES_START_MONTH,TIER_MILES_EVAL_PERIOD,ENROL_RETRO_CREDIT_PERIOD,STG_PROCESS_DATE,SDW_CREATED_DATE,SDW_CHANGED_DATE,SDW_REFRESH_DATE,TIER_MILES_RND_EVAL_PERIOD,ACTIVATION_REQUIRED,CHARGEABLE,TIER_LEVEL_IND,TIER_BONUS_LIMIT,PRODUCT_CODE,BASE_TIER</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>CREATED=String,CHANGED=String,STG_PROCESS_DATE=String,SDW_CREATED_DATE=String,SDW_CHANGED_DATE=String,SDW_REFRESH_DATE=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>CODE</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_MEMBERSHIP_TIERS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_MEMBERSHIP_TIERS}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <fork name="fork-0bc8">
        <path start="sqoop-38e6" />
        <path start="sqoop-2151" />
        <path start="sqoop-8dc6" />
        <path start="sqoop-77ec" />
        <path start="sqoop-4a3f" />
        <path start="sqoop-67c5" />
        <path start="sqoop-90ee" />
        <path start="sqoop-9fcb" />
        <path start="sqoop-e084" />
        <path start="sqoop-5551" />
    </fork>
    <join name="join-cd29" to="fs-da17"/>
    <action name="sqoop-8dc6">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_PREFERENCES}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_PREFERENCES</arg>
              <arg>--columns</arg>
              <arg>PREFERENCE_DATE,PREFERENCE_DETAIL,PERSON_ID,SPRF_USR_CREATED,SPRF_CREATED,SPRF_USR_CHANGED,SPRF_CHANGED,STG_PROCESS_DATE,PREF_TYPE_CODE,PREF_TYPE_DESCR,PREF_CATEGORY_ID,PREF_CATEGORY_DESCR,SDW_CREATED_DATE,SDW_CHANGED_DATE,SDW_REFRESH_DATE,PARENT_CARD_NO</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>PREFERENCE_DATE=String,SPRF_CREATED=String,SPRF_CHANGED=String,STG_PROCESS_DATE=String,SDW_CREATED_DATE=String,SDW_CHANGED_DATE=String,SDW_REFRESH_DATE=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>PERSON_ID</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_PREFERENCES</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_PREFERENCES}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <action name="sqoop-77ec">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_CONTACT_NUMBERS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_CONTACT_NUMBERS</arg>
              <arg>--columns</arg>
              <arg>PREFERED_CONTACT_TYPE,STG_PROCESS_DATE,SDW_REFRESH_DATE,SDW_CHANGED_DATE,SDW_CREATED_DATE,HOME_TEL_NUMBER,FAX_NUMBER,WORK_TEL_NUMBER,MOBILE_NUMBER,PREFERED_CONTACT_NUMBER,PER_PERSON_ID,PARENT_CARD_NO,HOME_CHANGED,HOME_USR_CHANGED,HOME_CREATED,HOME_USR_CREATED,FAX_CHANGED,FAX_USR_CHANGED,FAX_CREATED,FAX_USR_CREATED,WORK_CHANGED,WORK_USR_CHANGED,WORK_CREATED,WORK_USR_CREATED,MOB_CHANGED,MOB_USR_CHANGED,MOB_CREATED,MOB_USR_CREATED,PREF_CHANGED,PREF_USR_CHANGED,PREF_CREATED,PREF_USR_CREATED,ORGANISATION_ID</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>STG_PROCESS_DATE=String,SDW_REFRESH_DATE=String,SDW_CHANGED_DATE=String,SDW_CREATED_DATE=String,HOME_CHANGED=String,HOME_CREATED=String,FAX_CHANGED=String,FAX_CREATED=String,WORK_CHANGED=String,WORK_CREATED=String,MOB_CHANGED=String,MOB_CREATED=String,PREF_CHANGED=String,PREF_CREATED=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>PER_PERSON_ID</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_CONTACT_NUMBERS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_CONTACT_NUMBERS}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <action name="sqoop-4a3f">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_PASSPORTS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_PASSPORTS</arg>
              <arg>--columns</arg>
              <arg>SDW_REFRESH_DATE,SDW_CHANGED_DATE,SDW_CREATED_DATE,LPT_CODE,COUNTRY_NAME,COUNTRY_IATA_CODE,STG_PROCESS_DATE,PPT_SEQ_NO,FIRST_NAME,MIDDLE_NAME,LAST_NAME,PLACE_OF_ISSUE,PLACE_OF_BIRTH,CHANGED,USR_CHANGED,EXP_DATE,ISSUE_DATE,PPT_TYPE,NATIONALITY,COU_IATA_CODE,CREATED,USR_CREATED,PERSON_ID,PASSPORT_NO,PARENT_CARD_NO</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>SDW_REFRESH_DATE=String,SDW_CHANGED_DATE=String,SDW_CREATED_DATE=String,STG_PROCESS_DATE=String,CHANGED=String,EXP_DATE=String,ISSUE_DATE=String,CREATED=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>PERSON_ID</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_PASSPORTS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_PASSPORTS}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <action name="fs-da17">
        <fs>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_CONTACT_NUMBERS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_CUSTOMER/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_MEMBERSHIP_TIERS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_MEMBER_ALIAS_CARDS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_PASSPORTS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_PREFERENCES/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/VW_EK_DESTINATIONS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/VW_SLC_NATIONALITY_THRESH/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_MEMBERSHIP_CARDS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_LOCATIONS/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
              <chmod path='${nameNode}/data/helix/raw/CDML/SDW_ADDRESSES/full/' permissions='777' dir-files='false'>
                <recursive/>
              </chmod>
        </fs>
        <ok to="End"/>
        <error to="email-cb7f"/>
    </action>
    <action name="sqoop-67c5">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_VW_EK_DESTINATIONS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--query</arg>
              <arg>&quot;SELECT SDW_REFRESH_DATE,AIRPORT_IATA_CODE,AIRPORT_NAME,USR_CREATED,CREATED,USR_CHANGED,CHANGED,HOST_ONLINE_APT,STG_PROCESS_DATE,CITY_IATA_CODE,CITY_NAME,COUNTRY_IATA_CODE,COUNTRY_NAME,CURRENCY_CODE,CURRENCY_NAME,TERRITORY_CODE,AMC_CODE,TERRITORY_DSCR,SDW_CREATED_DATE,SDW_CHANGED_DATE FROM DW_OWNR.VW_EK_DESTINATIONS WHERE $CONDITIONS&quot;</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>SDW_REFRESH_DATE=String,CREATED=String,CHANGED=String,STG_PROCESS_DATE=String,SDW_CREATED_DATE=String,SDW_CHANGED_DATE=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>VW_EK_DESTINATIONS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_VW_EK_DESTINATIONS}</arg>
              <arg>-m</arg>
              <arg>1</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <action name="email-cb7f">
        <email xmlns="uri:oozie:email-action:0.2">
            <to>HelixSupport@emirates.com</to>
            <subject>Workflow ${wf:name()} failed</subject>
            <body>Current timestamp: ${timestamp()}
Workflow name: ${wf:name()}
Workflow id: ${wf:id()}
Workflow application path: ${wf:appPath()}
Workflow user: ${wf:user()}
Last error action: ${wf:lastErrorNode()}
Error code: ${wf:errorCode(wf:lastErrorNode())}
Error message: ${wf:errorMessage(wf:lastErrorNode())}</body>
            <content_type>text/plain</content_type>
        </email>
        <ok to="Kill"/>
        <error to="Kill"/>
    </action>
    <action name="sqoop-90ee">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_VW_SLC_NATIONALITY_THRESH}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--query</arg>
              <arg>&quot;SELECT COUNTRY_OF_RESIDENCE,NATIONALITY,FROM_LOC,TO_LOC,Y_FLEXMILES FROM VW_SLC_NATIONALITY_THRESH WHERE $CONDITIONS&quot;</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>VW_SLC_NATIONALITY_THRESH</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_VW_SLC_NATIONALITY_THRESH}</arg>
              <arg>-m</arg>
              <arg>1</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="Kill"/>
    </action>
    <action name="sqoop-9fcb">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_MEMBERSHIP_CARDS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--query</arg>
              <arg>&quot;SELECT PERSON_ID, CARD_NO, MEMBER_ID, USR_CREATED, CREATED, ISSUE_DATE, ISSUE_REASON, REVIEW_DUE_DATE, ACTIVE_STATUS, TERM_DATE, RULE_CODE, REPLACE_DUE_DATE, TIER_CHNG_DATE, CARD_REQD, REISSUE_NO, REISSUE_CHARGE_DUE, LTST_REISSUE_REASON, LTST_REISSUE_REQ_DT, MANUAL_CREATE, CLOSE_TO_DGRADE, QUICK_MOVEMENT, STOLEN, CARD_PULL_DATE, USR_CHANGED, CHANGED, ACTIVATION_REQD, SEQUENCE_NO, PULLED_COUNT, QRS_LAST_ACT_DATE, PMA_ID, MAILING_DATE, DELIVERY_DATE, RETURNED_DATE, FULFILMENT_STATUS, CARD_EXPIRY_RETAINED, STG_PROCESS_DATE, TIER_CHNG_RSN_CODE, TIER_CHNG_RSN_DESCR, CARD_ISSUE_RSN, TIER_CODE, TIER_TYPE, SEQ_NUMBER, TIER_DESCRIPTION, CARD_NO_PREFIX, TIER_RESOLUTION_CODE, SDW_CREATED_DATE, SDW_CHANGED_DATE, SDW_REFRESH_DATE, RENEWAL_PROMOTION_AVAILED, REN_PROMOTION_START_DATE, REN_PROMOTION_END_DATE, REN_MILES_TO_BE_ACCURED, QRS_CODE_SECOND_CHANCE, TIER_MILES_RND_EVAL_PERIOD, PRINTED_DATE, SMS_SENT, CORP_COBRAND, SEN_CODE, CARD_TYPE, MEM_GIFT_ID, REASON, REQUALIFY_DATE, MEM_GIFT_DESCR, CARD_DELV_FULF_ADDR, PLASTIC_CARD, ADDR_CONF_REQ_FLAG, ADDR_CONF_REQ_DATE, ADDR_CONF_FLAG, ADDR_CONF_DATE from SDW_MEMBERSHIP_CARDS WHERE $CONDITIONS&quot;</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_MEMBERSHIP_CARDS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_MEMBERSHIP_CARDS}</arg>
              <arg>--map-column-java</arg>
              <arg>CREATED=String,ISSUE_DATE=String,REVIEW_DUE_DATE=String,TERM_DATE=String,REPLACE_DUE_DATE=String,TIER_CHNG_DATE=String,LTST_REISSUE_REQ_DT=String,CARD_PULL_DATE=String,CHANGED=String,QRS_LAST_ACT_DATE=String,MAILING_DATE=String,DELIVERY_DATE=String,RETURNED_DATE=String,STG_PROCESS_DATE=String,SDW_CREATED_DATE=String,SDW_CHANGED_DATE=String,SDW_REFRESH_DATE=String,REN_PROMOTION_START_DATE=String,REN_PROMOTION_END_DATE=String,PRINTED_DATE=String,REQUALIFY_DATE=String,ADDR_CONF_REQ_DATE=String,ADDR_CONF_DATE=String</arg>
              <arg>--split-by</arg>
              <arg>CARD_NO</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="Kill"/>
    </action>
    <action name="sqoop-e084">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_ADDRESSES}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_ADDRESSES</arg>
              <arg>--columns</arg>
              <arg>ADD_ID,USR_CREATED,CREATED,LCN_LCN_ID,ADD_CONTEXT,ORG_ORG_ID,TELEPHONE_NO,PER_PERSON_ID,JOB_TITLE,DEPT,LOCN_PREFIX,CO_NAME,EXTN,FAX_NO,MOBILE_NO,EMAIL_ADDRESS,SITA_NO,TELEX_NO,SEND_CARE_OF,CMNTS,PREF_CONTACT,MATCH_STRING,MATCH_STRING2,USR_CHANGED,CHANGED,QAS_FLAG,QAS_UNUSED,INVALID_ADDRESS,STG_PROCESS_DATE,SDW_CREATED_DATE,SDW_CHANGED_DATE,SDW_REFRESH_DATE,PARENT_CARD_NO,CREATED_ADMIN,CHANGED_ADMIN</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>CHANGED=String,STG_PROCESS_DATE=String,SDW_REFRESH_DATE=String,SDW_CHANGED_DATE=String,SDW_CREATED_DATE=String,CREATED=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>PER_PERSON_ID</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_ADDRESSES</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_ADDRESSES}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <action name="sqoop-5551">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
            <job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
            <prepare>
                  <delete path="${PATH_SDW_LOCATIONS}"/>
            </prepare>
              <arg>import</arg>
              <arg>-D</arg>
              <arg>mapred.child.java.opts=&quot;-Djava.security.egd=file:/dev/../dev/urandom&quot;</arg>
              <arg>--options-file</arg>
              <arg>${SDW_SQOOP_OPTIONS_FILE}</arg>
              <arg>--table</arg>
              <arg>DW_OWNR.SDW_LOCATIONS</arg>
              <arg>--columns</arg>
              <arg>LCN_ID,COU_IATA_CODE,STREET,TOWN,USR_CREATED,CREATED,DESCRIPTION,CO_NAME,BUILDING,LOCALITY,REGION,ADDRESS_KEY,MAIL_SORT_KEY,POST_CODE,MATCH_STRING,USR_CHANGED,CHANGED,PO_BOX,CTY_IATA_CODE,SOF_CODE,SEND_CARE_OF,REGION_CODE,STG_PROCESS_DATE,SDW_CREATED_DATE,SDW_CHANGED_DATE,SDW_REFRESH_DATE,PARENT_CARD_NO</arg>
              <arg>--as-avrodatafile</arg>
              <arg>--map-column-java</arg>
              <arg>SDW_REFRESH_DATE=String,SDW_CHANGED_DATE=String,SDW_CREATED_DATE=String,STG_PROCESS_DATE=String,CHANGED=String,CREATED=String</arg>
              <arg>--enclosed-by</arg>
              <arg>&#39;\&quot;&#39;</arg>
              <arg>--split-by</arg>
              <arg>LCN_ID</arg>
              <arg>--null-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--null-non-string</arg>
              <arg>&#39;\\N&#39;</arg>
              <arg>--class-name</arg>
              <arg>SDW_LOCATIONS</arg>
              <arg>--compress</arg>
              <arg>--compression-codec</arg>
              <arg>org.apache.hadoop.io.compress.SnappyCodec</arg>
              <arg>--target-dir</arg>
              <arg>${PATH_SDW_LOCATIONS}</arg>
            <file>${SDW_SQOOP_OPTIONS_FILE}#${SDW_SQOOP_OPTIONS_FILE}</file>
        </sqoop>
        <ok to="join-cd29"/>
        <error to="email-cb7f"/>
    </action>
    <end name="End"/>
</workflow-app>