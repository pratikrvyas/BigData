package com.emirates.helix

import org.apache.spark.SparkConf
import org.apache.spark.SparkContext
import org.apache.spark.rdd.RDD
import org.apache.spark.sql.SQLContext._
import org.apache.spark.sql.DataFrame;
import org.apache.spark.sql.functions._
import org.apache.spark.sql.SQLImplicits;
import org.apache.spark.sql.Row
import org.apache.spark.sql.hive.HiveContext
import org.apache.spark.sql.hive._
import org.apache.log4j.Logger
import org.apache.log4j.Level
import org.apache.log4j.LogManager
import org.apache.spark.sql.functions.{ rowNumber, max, broadcast }
import org.apache.spark.sql.expressions.Window;
import org.apache.spark.sql.functions.row_number;
import scala.util.control.Exception._
import org.apache.spark.sql.{ SaveMode, DataFrame, SQLContext, Row }
import scala.util.{ Try, Success, Failure }
import java.text.SimpleDateFormat
import com.databricks.spark.avro._
import com.emirates.helix.utils._
object DedupFuelMonData extends sparkUtils {
  val conf = sparkConfig("Ancillary Cartrawler Merge/Model Data");
  val sc = new SparkContext(conf);
  //val sqlContext = getSQLContext(sc);
  val sqlContext = getHiveContext(sc)
  val logger = LogManager.getRootLogger
  // This Method is to process the cartrawler Decomposed data
  def decompdataprocess(base_Input_Path: String, incr_Input_path: String, hist_Output_Path: String,inct_Output_Path: String, incr_Output_Path_Temp: String, loadType: String, months: Integer) {
    import sqlContext.implicits._
    //target path formation
    try {
      //target path formation
      var srcDataPath = "";
      var dfDedupDecomData = Seq((1, 2, 3), (4, 5, 6)).toDF
      if (loadType.toUpperCase == "INITIAL") {
        srcDataPath = base_Input_Path; // + "/*/*/*/*";
        dfDedupDecomData = dedupdecompdata(srcDataPath);
        dfDedupDecomData.registerTempTable("dedupTemp");
        val max_flight_date = sqlContext.sql("select max(to_date(FLIGHT_DATE)) from dedupTemp").first().mkString;
        val incr_sql = "select * from dedupTemp where to_date(FLIGHT_DATE) >= add_months(to_date('" + max_flight_date + "')," + -1 * months + ")"
        val hist_sql = "select * from dedupTemp where to_date(FLIGHT_DATE) < add_months(to_date('" + max_flight_date + "')," + -1 * months + ")"
        val output_df_last_incr = sqlContext.sql(incr_sql)
        val output_df_last_hist = sqlContext.sql(hist_sql)
        output_df_last_incr.write.mode("overwrite").parquet(inct_Output_Path);
        output_df_last_hist.write.mode("overwrite").parquet(hist_Output_Path);
        output_df_last_incr.write.mode("overwrite").parquet(incr_Output_Path_Temp);
      } else {
        //read latest snap data from HDFS target location
        val dfTgtSnap = sqlContext.read.format("parquet").load(inct_Output_Path);
        //read latest input data from decomposed data
       /* dfDedupDecomData = dedupdecompdata(incr_Input_path);
        //Join on Decomposed sorce and merge target data
        val dfSnapSrcJn = dfDedupDecomData.join(dfTgtSnap, (dfDedupDecomData("FLIGHTNO") === dfTgtSnap("FLIGHTNO") && dfDedupDecomData("FLIGHT_DATE") === dfTgtSnap("FLIGHT_DATE") && dfDedupDecomData("DEP_STN") === dfTgtSnap("DEP_STN") && dfDedupDecomData("ARV_STN") === dfTgtSnap("ARV_STN") && dfDedupDecomData("ACREG") === dfTgtSnap("ACREG")), "full_outer").select(dfDedupDecomData("FLIGHTNO") as "FLIGHTNO_Src", dfDedupDecomData("FLIGHT_DATE") as "FLIGHT_DATE_Src", dfDedupDecomData("DEP_STN") as "DEP_STN_Src", dfDedupDecomData("ARV_STN") as "ARV_STN_Src", dfDedupDecomData("ACREG") as "ACREG_Src", dfDedupDecomData("AC_TYPE") as "AC_TYPE_Src", dfDedupDecomData("PIC") as "PIC_Src", dfDedupDecomData("PIC_USERUPDATE") as "PIC_USERUPDATE_Src", dfDedupDecomData("GND_DIST") as "GND_DIST_Src", dfDedupDecomData("AIR_DIST") as "AIR_DIST_Src", dfDedupDecomData("AV_WIND_COMP") as "AV_WIND_COMP_Src", dfDedupDecomData("MIN_FUEL") as "MIN_FUEL_Src", dfDedupDecomData("RAMP_FUEL") as "RAMP_FUEL_Src", dfDedupDecomData("CFP_EXTRA") as "CFP_EXTRA_Src", dfDedupDecomData("CFP_USERUPDATE") as "CFP_USERUPDATE_Src", dfDedupDecomData("ALTN_FUEL") as "ALTN_FUEL_Src", dfDedupDecomData("FINAL_FUEL") as "FINAL_FUEL_Src", dfDedupDecomData("ADDNLFUEL1") as "ADDNLFUEL1_Src", dfDedupDecomData("ADDNLFUELREASON1") as "ADDNLFUELREASON1_Src", dfDedupDecomData("ADDNLFUEL2") as "ADDNLFUEL2_Src", dfDedupDecomData("ADDNLFUELREASON2") as "ADDNLFUELREASON2_Src", dfDedupDecomData("ADDNLFUEL3") as "ADDNLFUEL3_Src", dfDedupDecomData("ADDNLFUELREASON3") as "ADDNLFUELREASON3_Src", dfDedupDecomData("ADDNLFUEL4") as "ADDNLFUEL4_Src", dfDedupDecomData("ADDNLFUELREASON4") as "ADDNLFUELREASON4_Src", dfDedupDecomData("PLN_TRIP_TIME") as "PLN_TRIP_TIME_Src", dfDedupDecomData("PLN_BLK_TIME") as "PLN_BLK_TIME_Src", dfDedupDecomData("PLN_CONTINGENCY_FUEL") as "PLN_CONTINGENCY_FUEL_Src", dfDedupDecomData("ACT_CONTINGENCY_USED") as "ACT_CONTINGENCY_USED_Src", dfDedupDecomData("PLN_MIN_FUEL_ON_ARV") as "PLN_MIN_FUEL_ON_ARV_Src", dfDedupDecomData("PLN_TAXI_FUEL_OUT") as "PLN_TAXI_FUEL_OUT_Src", dfDedupDecomData("ACT_TAXI_FUEL_OUT") as "ACT_TAXI_FUEL_OUT_Src", dfDedupDecomData("PLN_TAXI_FUEL_IN") as "PLN_TAXI_FUEL_IN_Src", dfDedupDecomData("ACT_TAXI_FUEL_IN") as "ACT_TAXI_FUEL_IN_Src", dfDedupDecomData("PLN_TRIP_FUEL") as "PLN_TRIP_FUEL_Src", dfDedupDecomData("ACT_TRIP_FUEL") as "ACT_TRIP_FUEL_Src", dfDedupDecomData("PLN_BLK_FUEL") as "PLN_BLK_FUEL_Src", dfDedupDecomData("ACT_BLK_FUEL") as "ACT_BLK_FUEL_Src", dfDedupDecomData("PLN_ZFW") as "PLN_ZFW_Src", dfDedupDecomData("ACT_ZFW") as "ACT_ZFW_Src", dfDedupDecomData("TANKERING_STATUS_ID") as "TANKERING_STATUS_ID_Src", dfDedupDecomData("TANKERING_FUEL") as "TANKERING_FUEL_Src", dfDedupDecomData("PLN_TAKE_OFF_WT") as "PLN_TAKE_OFF_WT_Src", dfDedupDecomData("ACT_TAKE_OFF_WT") as "ACT_TAKE_OFF_WT_Src", dfDedupDecomData("PLN_TAKE_OFF_FUEL") as "PLN_TAKE_OFF_FUEL_Src", dfDedupDecomData("FUEL_OUT") as "FUEL_OUT_Src", dfDedupDecomData("FUEL_OFF") as "FUEL_OFF_Src", dfDedupDecomData("FUEL_ON") as "FUEL_ON_Src", dfDedupDecomData("FUEL_IN") as "FUEL_IN_Src", dfDedupDecomData("EXT_FUEL_REASON") as "EXT_FUEL_REASON_Src", dfDedupDecomData("REMARK") as "REMARK_Src", dfDedupDecomData("ZFW_CORRECTION") as "ZFW_CORRECTION_Src", dfDedupDecomData("ADJS_EXTRA_FUEL") as "ADJS_EXTRA_FUEL_Src", dfDedupDecomData("EXCESS_ARV_FUEL") as "EXCESS_ARV_FUEL_Src", dfDedupDecomData("ADJS_EX_ARV_FUEL") as "ADJS_EX_ARV_FUEL_Src", dfDedupDecomData("EXT_FUEL_PENALTY") as "EXT_FUEL_PENALTY_Src", dfDedupDecomData("FUEL_BURN_SAVED") as "FUEL_BURN_SAVED_Src", dfDedupDecomData("EXT_FUEL_CATEGORY") as "EXT_FUEL_CATEGORY_Src", dfDedupDecomData("PCT_CONT_USED") as "PCT_CONT_USED_Src", dfDedupDecomData("MODON") as "MODON_Src", dfDedupDecomData("MODBY") as "MODBY_Src", dfDedupDecomData("EXTRA_FUEL_CATEFORIZATION") as "EXTRA_FUEL_CATEFORIZATION_Src", dfDedupDecomData("WABI_TOF") as "WABI_TOF_Src", dfDedupDecomData("VERIFIED") as "VERIFIED_Src", dfDedupDecomData("CRZ_DEG") as "CRZ_DEG_Src", dfDedupDecomData("COST_IDX") as "COST_IDX_Src", dfDedupDecomData("ISA") as "ISA_Src", dfDedupDecomData("ALT_DEST1") as "ALT_DEST1_Src", dfDedupDecomData("ALT_DEST_RW1") as "ALT_DEST_RW1_Src", dfDedupDecomData("ALT_DIST1") as "ALT_DIST1_Src", dfDedupDecomData("ALT_DEST2") as "ALT_DEST2_Src", dfDedupDecomData("ALT_DEST_RW2") as "ALT_DEST_RW2_Src", dfDedupDecomData("ALT_DIST2") as "ALT_DIST2_Src", dfDedupDecomData("ALT_DEST3") as "ALT_DEST3_Src", dfDedupDecomData("ALT_DEST_RW3") as "ALT_DEST_RW3_Src", dfDedupDecomData("ALT_DIST3") as "ALT_DIST3_Src", dfDedupDecomData("ALT_DEST4") as "ALT_DEST4_Src", dfDedupDecomData("ALT_DEST_RW4") as "ALT_DEST_RW4_Src", dfDedupDecomData("ALT_DIST4") as "ALT_DIST4_Src", dfDedupDecomData("CRZ_FL") as "CRZ_FL_Src", dfDedupDecomData("CRZ_TEMP") as "CRZ_TEMP_Src", dfDedupDecomData("DOW_MIN") as "DOW_MIN_Src", dfDedupDecomData("DOW_MAX") as "DOW_MAX_Src", dfDedupDecomData("DOI_RANGE_MIN") as "DOI_RANGE_MIN_Src", dfDedupDecomData("DOI_RANGE_MAX") as "DOI_RANGE_MAX_Src", dfDedupDecomData("ELWT") as "ELWT_Src", dfDedupDecomData("PLN_TAXI_OUT_TIME") as "PLN_TAXI_OUT_TIME_Src", dfDedupDecomData("ACT_TAXI_OUT_TIME") as "ACT_TAXI_OUT_TIME_Src", dfDedupDecomData("PLN_TAXI_IN_TIME") as "PLN_TAXI_IN_TIME_Src", dfDedupDecomData("ACT_TAXI_IN_TIME") as "ACT_TAXI_IN_TIME_Src", dfDedupDecomData("FUELTD_GT_MINFUEL") as "FUELTD_GT_MINFUEL_Src", dfDedupDecomData("DUP_OR_NULL_PIC_FLAG") as "DUP_OR_NULL_PIC_FLAG_Src", dfDedupDecomData("CARCODE") as "CARCODE_Src", dfDedupDecomData("PIC_MFP") as "PIC_MFP_Src", dfDedupDecomData("CAP_NAME_MFP") as "CAP_NAME_MFP_Src", dfDedupDecomData("MFP_FILE_PATH") as "MFP_FILE_PATH_Src", dfDedupDecomData("HELIX_UUID") as "HELIX_UUID_Src", dfDedupDecomData("HELIX_TIMESTAMP") as "HELIX_TIMESTAMP_Src",
          dfTgtSnap("FLIGHTNO"), dfTgtSnap("FLIGHT_DATE"), dfTgtSnap("DEP_STN"), dfTgtSnap("ARV_STN"), dfTgtSnap("ACREG"), dfTgtSnap("AC_TYPE"), dfTgtSnap("PIC"), dfTgtSnap("PIC_USERUPDATE"), dfTgtSnap("GND_DIST"), dfTgtSnap("AIR_DIST"), dfTgtSnap("AV_WIND_COMP"), dfTgtSnap("MIN_FUEL"), dfTgtSnap("RAMP_FUEL"), dfTgtSnap("CFP_EXTRA"), dfTgtSnap("CFP_USERUPDATE"), dfTgtSnap("ALTN_FUEL"), dfTgtSnap("FINAL_FUEL"), dfTgtSnap("ADDNLFUEL1"), dfTgtSnap("ADDNLFUELREASON1"), dfTgtSnap("ADDNLFUEL2"), dfTgtSnap("ADDNLFUELREASON2"), dfTgtSnap("ADDNLFUEL3"), dfTgtSnap("ADDNLFUELREASON3"), dfTgtSnap("ADDNLFUEL4"), dfTgtSnap("ADDNLFUELREASON4"), dfTgtSnap("PLN_TRIP_TIME"), dfTgtSnap("PLN_BLK_TIME"), dfTgtSnap("PLN_CONTINGENCY_FUEL"), dfTgtSnap("ACT_CONTINGENCY_USED"), dfTgtSnap("PLN_MIN_FUEL_ON_ARV"), dfTgtSnap("PLN_TAXI_FUEL_OUT"), dfTgtSnap("ACT_TAXI_FUEL_OUT"), dfTgtSnap("PLN_TAXI_FUEL_IN"), dfTgtSnap("ACT_TAXI_FUEL_IN"), dfTgtSnap("PLN_TRIP_FUEL"), dfTgtSnap("ACT_TRIP_FUEL"), dfTgtSnap("PLN_BLK_FUEL"), dfTgtSnap("ACT_BLK_FUEL"), dfTgtSnap("PLN_ZFW"), dfTgtSnap("ACT_ZFW"), dfTgtSnap("TANKERING_STATUS_ID"), dfTgtSnap("TANKERING_FUEL"), dfTgtSnap("PLN_TAKE_OFF_WT"), dfTgtSnap("ACT_TAKE_OFF_WT"), dfTgtSnap("PLN_TAKE_OFF_FUEL"), dfTgtSnap("FUEL_OUT"), dfTgtSnap("FUEL_OFF"), dfTgtSnap("FUEL_ON"), dfTgtSnap("FUEL_IN"), dfTgtSnap("EXT_FUEL_REASON"), dfTgtSnap("REMARK"), dfTgtSnap("ZFW_CORRECTION"), dfTgtSnap("ADJS_EXTRA_FUEL"), dfTgtSnap("EXCESS_ARV_FUEL"), dfTgtSnap("ADJS_EX_ARV_FUEL"), dfTgtSnap("EXT_FUEL_PENALTY"), dfTgtSnap("FUEL_BURN_SAVED"), dfTgtSnap("EXT_FUEL_CATEGORY"), dfTgtSnap("PCT_CONT_USED"), dfTgtSnap("MODON"), dfTgtSnap("MODBY"), dfTgtSnap("EXTRA_FUEL_CATEFORIZATION"), dfTgtSnap("WABI_TOF"), dfTgtSnap("VERIFIED"), dfTgtSnap("CRZ_DEG"), dfTgtSnap("COST_IDX"), dfTgtSnap("ISA"), dfTgtSnap("ALT_DEST1"), dfTgtSnap("ALT_DEST_RW1"), dfTgtSnap("ALT_DIST1"), dfTgtSnap("ALT_DEST2"), dfTgtSnap("ALT_DEST_RW2"), dfTgtSnap("ALT_DIST2"), dfTgtSnap("ALT_DEST3"), dfTgtSnap("ALT_DEST_RW3"), dfTgtSnap("ALT_DIST3"), dfTgtSnap("ALT_DEST4"), dfTgtSnap("ALT_DEST_RW4"), dfTgtSnap("ALT_DIST4"), dfTgtSnap("CRZ_FL"), dfTgtSnap("CRZ_TEMP"), dfTgtSnap("DOW_MIN"), dfTgtSnap("DOW_MAX"), dfTgtSnap("DOI_RANGE_MIN"), dfTgtSnap("DOI_RANGE_MAX"), dfTgtSnap("ELWT"), dfTgtSnap("PLN_TAXI_OUT_TIME"), dfTgtSnap("ACT_TAXI_OUT_TIME"), dfTgtSnap("PLN_TAXI_IN_TIME"), dfTgtSnap("ACT_TAXI_IN_TIME"), dfTgtSnap("FUELTD_GT_MINFUEL"), dfTgtSnap("DUP_OR_NULL_PIC_FLAG"), dfTgtSnap("CARCODE"), dfTgtSnap("PIC_MFP"), dfTgtSnap("CAP_NAME_MFP"), dfTgtSnap("MFP_FILE_PATH"), dfTgtSnap("HELIX_UUID"), dfTgtSnap("HELIX_TIMESTAMP"));
        //data process on resultant join
        val dfRes = dfSnapSrcJn.select((when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FLIGHTNO_Src")).otherwise(col("FLIGHTNO"))) as "FLIGHTNO", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FLIGHT_DATE_Src")).otherwise(col("FLIGHT_DATE"))) as "FLIGHT_DATE", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("DEP_STN_Src")).otherwise(col("DEP_STN"))) as "DEP_STN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ARV_STN_Src")).otherwise(col("ARV_STN"))) as "ARV_STN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACREG_Src")).otherwise(col("ACREG"))) as "ACREG", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("AC_TYPE_Src")).otherwise(col("AC_TYPE"))) as "AC_TYPE", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PIC_Src")).otherwise(col("PIC"))) as "PIC", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PIC_USERUPDATE_Src")).otherwise(col("PIC_USERUPDATE"))) as "PIC_USERUPDATE", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("GND_DIST_Src")).otherwise(col("GND_DIST"))) as "GND_DIST", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("AIR_DIST_Src")).otherwise(col("AIR_DIST"))) as "AIR_DIST", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("AV_WIND_COMP_Src")).otherwise(col("AV_WIND_COMP"))) as "AV_WIND_COMP", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("MIN_FUEL_Src")).otherwise(col("MIN_FUEL"))) as "MIN_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("RAMP_FUEL_Src")).otherwise(col("RAMP_FUEL"))) as "RAMP_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CFP_EXTRA_Src")).otherwise(col("CFP_EXTRA"))) as "CFP_EXTRA", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CFP_USERUPDATE_Src")).otherwise(col("CFP_USERUPDATE"))) as "CFP_USERUPDATE", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALTN_FUEL_Src")).otherwise(col("ALTN_FUEL"))) as "ALTN_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FINAL_FUEL_Src")).otherwise(col("FINAL_FUEL"))) as "FINAL_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUEL1_Src")).otherwise(col("ADDNLFUEL1"))) as "ADDNLFUEL1", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUELREASON1_Src")).otherwise(col("ADDNLFUELREASON1"))) as "ADDNLFUELREASON1", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUEL2_Src")).otherwise(col("ADDNLFUEL2"))) as "ADDNLFUEL2", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUELREASON2_Src")).otherwise(col("ADDNLFUELREASON2"))) as "ADDNLFUELREASON2", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUEL3_Src")).otherwise(col("ADDNLFUEL3"))) as "ADDNLFUEL3", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUELREASON3_Src")).otherwise(col("ADDNLFUELREASON3"))) as "ADDNLFUELREASON3", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUEL4_Src")).otherwise(col("ADDNLFUEL4"))) as "ADDNLFUEL4", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADDNLFUELREASON4_Src")).otherwise(col("ADDNLFUELREASON4"))) as "ADDNLFUELREASON4", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TRIP_TIME_Src")).otherwise(col("PLN_TRIP_TIME"))) as "PLN_TRIP_TIME", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_BLK_TIME_Src")).otherwise(col("PLN_BLK_TIME"))) as "PLN_BLK_TIME", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_CONTINGENCY_FUEL_Src")).otherwise(col("PLN_CONTINGENCY_FUEL"))) as "PLN_CONTINGENCY_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_CONTINGENCY_USED_Src")).otherwise(col("ACT_CONTINGENCY_USED"))) as "ACT_CONTINGENCY_USED", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_MIN_FUEL_ON_ARV_Src")).otherwise(col("PLN_MIN_FUEL_ON_ARV"))) as "PLN_MIN_FUEL_ON_ARV", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TAXI_FUEL_OUT_Src")).otherwise(col("PLN_TAXI_FUEL_OUT"))) as "PLN_TAXI_FUEL_OUT", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_TAXI_FUEL_OUT_Src")).otherwise(col("ACT_TAXI_FUEL_OUT"))) as "ACT_TAXI_FUEL_OUT", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TAXI_FUEL_IN_Src")).otherwise(col("PLN_TAXI_FUEL_IN"))) as "PLN_TAXI_FUEL_IN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_TAXI_FUEL_IN_Src")).otherwise(col("ACT_TAXI_FUEL_IN"))) as "ACT_TAXI_FUEL_IN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TRIP_FUEL_Src")).otherwise(col("PLN_TRIP_FUEL"))) as "PLN_TRIP_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_TRIP_FUEL_Src")).otherwise(col("ACT_TRIP_FUEL"))) as "ACT_TRIP_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_BLK_FUEL_Src")).otherwise(col("PLN_BLK_FUEL"))) as "PLN_BLK_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_BLK_FUEL_Src")).otherwise(col("ACT_BLK_FUEL"))) as "ACT_BLK_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_ZFW_Src")).otherwise(col("PLN_ZFW"))) as "PLN_ZFW", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_ZFW_Src")).otherwise(col("ACT_ZFW"))) as "ACT_ZFW", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("TANKERING_STATUS_ID_Src")).otherwise(col("TANKERING_STATUS_ID"))) as "TANKERING_STATUS_ID", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("TANKERING_FUEL_Src")).otherwise(col("TANKERING_FUEL"))) as "TANKERING_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TAKE_OFF_WT_Src")).otherwise(col("PLN_TAKE_OFF_WT"))) as "PLN_TAKE_OFF_WT", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_TAKE_OFF_WT_Src")).otherwise(col("ACT_TAKE_OFF_WT"))) as "ACT_TAKE_OFF_WT", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TAKE_OFF_FUEL_Src")).otherwise(col("PLN_TAKE_OFF_FUEL"))) as "PLN_TAKE_OFF_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FUEL_OUT_Src")).otherwise(col("FUEL_OUT"))) as "FUEL_OUT", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FUEL_OFF_Src")).otherwise(col("FUEL_OFF"))) as "FUEL_OFF", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FUEL_ON_Src")).otherwise(col("FUEL_ON"))) as "FUEL_ON", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FUEL_IN_Src")).otherwise(col("FUEL_IN"))) as "FUEL_IN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("EXT_FUEL_REASON_Src")).otherwise(col("EXT_FUEL_REASON"))) as "EXT_FUEL_REASON", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("REMARK_Src")).otherwise(col("REMARK"))) as "REMARK", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ZFW_CORRECTION_Src")).otherwise(col("ZFW_CORRECTION"))) as "ZFW_CORRECTION", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADJS_EXTRA_FUEL_Src")).otherwise(col("ADJS_EXTRA_FUEL"))) as "ADJS_EXTRA_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("EXCESS_ARV_FUEL_Src")).otherwise(col("EXCESS_ARV_FUEL"))) as "EXCESS_ARV_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ADJS_EX_ARV_FUEL_Src")).otherwise(col("ADJS_EX_ARV_FUEL"))) as "ADJS_EX_ARV_FUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("EXT_FUEL_PENALTY_Src")).otherwise(col("EXT_FUEL_PENALTY"))) as "EXT_FUEL_PENALTY", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FUEL_BURN_SAVED_Src")).otherwise(col("FUEL_BURN_SAVED"))) as "FUEL_BURN_SAVED", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("EXT_FUEL_CATEGORY_Src")).otherwise(col("EXT_FUEL_CATEGORY"))) as "EXT_FUEL_CATEGORY", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PCT_CONT_USED_Src")).otherwise(col("PCT_CONT_USED"))) as "PCT_CONT_USED", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("MODON_Src")).otherwise(col("MODON"))) as "MODON", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("MODBY_Src")).otherwise(col("MODBY"))) as "MODBY", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("EXTRA_FUEL_CATEFORIZATION_Src")).otherwise(col("EXTRA_FUEL_CATEFORIZATION"))) as "EXTRA_FUEL_CATEFORIZATION", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("WABI_TOF_Src")).otherwise(col("WABI_TOF"))) as "WABI_TOF", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("VERIFIED_Src")).otherwise(col("VERIFIED"))) as "VERIFIED", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CRZ_DEG_Src")).otherwise(col("CRZ_DEG"))) as "CRZ_DEG", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("COST_IDX_Src")).otherwise(col("COST_IDX"))) as "COST_IDX", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ISA_Src")).otherwise(col("ISA"))) as "ISA", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST1_Src")).otherwise(col("ALT_DEST1"))) as "ALT_DEST1", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST_RW1_Src")).otherwise(col("ALT_DEST_RW1"))) as "ALT_DEST_RW1", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DIST1_Src")).otherwise(col("ALT_DIST1"))) as "ALT_DIST1", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST2_Src")).otherwise(col("ALT_DEST2"))) as "ALT_DEST2", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST_RW2_Src")).otherwise(col("ALT_DEST_RW2"))) as "ALT_DEST_RW2", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DIST2_Src")).otherwise(col("ALT_DIST2"))) as "ALT_DIST2", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST3_Src")).otherwise(col("ALT_DEST3"))) as "ALT_DEST3", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST_RW3_Src")).otherwise(col("ALT_DEST_RW3"))) as "ALT_DEST_RW3", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DIST3_Src")).otherwise(col("ALT_DIST3"))) as "ALT_DIST3", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST4_Src")).otherwise(col("ALT_DEST4"))) as "ALT_DEST4", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DEST_RW4_Src")).otherwise(col("ALT_DEST_RW4"))) as "ALT_DEST_RW4", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ALT_DIST4_Src")).otherwise(col("ALT_DIST4"))) as "ALT_DIST4", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CRZ_FL_Src")).otherwise(col("CRZ_FL"))) as "CRZ_FL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CRZ_TEMP_Src")).otherwise(col("CRZ_TEMP"))) as "CRZ_TEMP", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("DOW_MIN_Src")).otherwise(col("DOW_MIN"))) as "DOW_MIN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("DOW_MAX_Src")).otherwise(col("DOW_MAX"))) as "DOW_MAX", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("DOI_RANGE_MIN_Src")).otherwise(col("DOI_RANGE_MIN"))) as "DOI_RANGE_MIN", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("DOI_RANGE_MAX_Src")).otherwise(col("DOI_RANGE_MAX"))) as "DOI_RANGE_MAX", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ELWT_Src")).otherwise(col("ELWT"))) as "ELWT", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TAXI_OUT_TIME_Src")).otherwise(col("PLN_TAXI_OUT_TIME"))) as "PLN_TAXI_OUT_TIME", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_TAXI_OUT_TIME_Src")).otherwise(col("ACT_TAXI_OUT_TIME"))) as "ACT_TAXI_OUT_TIME", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PLN_TAXI_IN_TIME_Src")).otherwise(col("PLN_TAXI_IN_TIME"))) as "PLN_TAXI_IN_TIME", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("ACT_TAXI_IN_TIME_Src")).otherwise(col("ACT_TAXI_IN_TIME"))) as "ACT_TAXI_IN_TIME", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("FUELTD_GT_MINFUEL_Src")).otherwise(col("FUELTD_GT_MINFUEL"))) as "FUELTD_GT_MINFUEL", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("DUP_OR_NULL_PIC_FLAG_Src")).otherwise(col("DUP_OR_NULL_PIC_FLAG"))) as "DUP_OR_NULL_PIC_FLAG", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CARCODE_Src")).otherwise(col("CARCODE"))) as "CARCODE", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("PIC_MFP_Src")).otherwise(col("PIC_MFP"))) as "PIC_MFP", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("CAP_NAME_MFP_Src")).otherwise(col("CAP_NAME_MFP"))) as "CAP_NAME_MFP", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("MFP_FILE_PATH_Src")).otherwise(col("MFP_FILE_PATH"))) as "MFP_FILE_PATH", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("HELIX_UUID_Src")).otherwise(col("HELIX_UUID"))) as "HELIX_UUID", (when(((col("FLIGHTNO").isNull || col("FLIGHTNO") === "") && (col("FLIGHT_DATE").isNull || col("FLIGHT_DATE") === "") && (col("DEP_STN").isNull || col("DEP_STN") === "") && (col("ARV_STN").isNull || col("ARV_STN") === "") && (col("ACREG").isNull || col("ACREG") === "")), col("HELIX_TIMESTAMP_Src")).otherwise(col("HELIX_TIMESTAMP"))) as "HELIX_TIMESTAMP", col("FLIGHTNO_Src"), col("FLIGHT_DATE_Src"), col("DEP_STN_Src"), col("ARV_STN_Src"), col("ACREG_Src"), col("AC_TYPE_Src"), col("PIC_Src"), col("PIC_USERUPDATE_Src"), col("GND_DIST_Src"), col("AIR_DIST_Src"), col("AV_WIND_COMP_Src"), col("MIN_FUEL_Src"), col("RAMP_FUEL_Src"), col("CFP_EXTRA_Src"), col("CFP_USERUPDATE_Src"), col("ALTN_FUEL_Src"), col("FINAL_FUEL_Src"), col("ADDNLFUEL1_Src"), col("ADDNLFUELREASON1_Src"), col("ADDNLFUEL2_Src"), col("ADDNLFUELREASON2_Src"), col("ADDNLFUEL3_Src"), col("ADDNLFUELREASON3_Src"), col("ADDNLFUEL4_Src"), col("ADDNLFUELREASON4_Src"), col("PLN_TRIP_TIME_Src"), col("PLN_BLK_TIME_Src"), col("PLN_CONTINGENCY_FUEL_Src"), col("ACT_CONTINGENCY_USED_Src"), col("PLN_MIN_FUEL_ON_ARV_Src"), col("PLN_TAXI_FUEL_OUT_Src"), col("ACT_TAXI_FUEL_OUT_Src"), col("PLN_TAXI_FUEL_IN_Src"), col("ACT_TAXI_FUEL_IN_Src"), col("PLN_TRIP_FUEL_Src"), col("ACT_TRIP_FUEL_Src"), col("PLN_BLK_FUEL_Src"), col("ACT_BLK_FUEL_Src"), col("PLN_ZFW_Src"), col("ACT_ZFW_Src"), col("TANKERING_STATUS_ID_Src"), col("TANKERING_FUEL_Src"), col("PLN_TAKE_OFF_WT_Src"), col("ACT_TAKE_OFF_WT_Src"), col("PLN_TAKE_OFF_FUEL_Src"), col("FUEL_OUT_Src"), col("FUEL_OFF_Src"), col("FUEL_ON_Src"), col("FUEL_IN_Src"), col("EXT_FUEL_REASON_Src"), col("REMARK_Src"), col("ZFW_CORRECTION_Src"), col("ADJS_EXTRA_FUEL_Src"), col("EXCESS_ARV_FUEL_Src"), col("ADJS_EX_ARV_FUEL_Src"), col("EXT_FUEL_PENALTY_Src"), col("FUEL_BURN_SAVED_Src"), col("EXT_FUEL_CATEGORY_Src"), col("PCT_CONT_USED_Src"), col("MODON_Src"), col("MODBY_Src"), col("EXTRA_FUEL_CATEFORIZATION_Src"), col("WABI_TOF_Src"), col("VERIFIED_Src"), col("CRZ_DEG_Src"), col("COST_IDX_Src"), col("ISA_Src"), col("ALT_DEST1_Src"), col("ALT_DEST_RW1_Src"), col("ALT_DIST1_Src"), col("ALT_DEST2_Src"), col("ALT_DEST_RW2_Src"), col("ALT_DIST2_Src"), col("ALT_DEST3_Src"), col("ALT_DEST_RW3_Src"), col("ALT_DIST3_Src"), col("ALT_DEST4_Src"), col("ALT_DEST_RW4_Src"), col("ALT_DIST4_Src"), col("CRZ_FL_Src"), col("CRZ_TEMP_Src"), col("DOW_MIN_Src"), col("DOW_MAX_Src"), col("DOI_RANGE_MIN_Src"), col("DOI_RANGE_MAX_Src"), col("ELWT_Src"), col("PLN_TAXI_OUT_TIME_Src"), col("ACT_TAXI_OUT_TIME_Src"), col("PLN_TAXI_IN_TIME_Src"), col("ACT_TAXI_IN_TIME_Src"), col("FUELTD_GT_MINFUEL_Src"), col("DUP_OR_NULL_PIC_FLAG_Src"), col("CARCODE_Src"), col("PIC_MFP_Src"), col("CAP_NAME_MFP_Src"), col("MFP_FILE_PATH_Src"), col("HELIX_UUID_Src"), col("HELIX_TIMESTAMP_Src"));
        val dfResFn = dfRes.select($"FLIGHTNO", $"FLIGHT_DATE", $"DEP_STN", $"ARV_STN", $"ACREG", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("AC_TYPE_Src")).otherwise(col("AC_TYPE"))) as "AC_TYPE", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PIC_Src")).otherwise(col("PIC"))) as "PIC", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PIC_USERUPDATE_Src")).otherwise(col("PIC_USERUPDATE"))) as "PIC_USERUPDATE", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("GND_DIST_Src")).otherwise(col("GND_DIST"))) as "GND_DIST", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("AIR_DIST_Src")).otherwise(col("AIR_DIST"))) as "AIR_DIST", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("AV_WIND_COMP_Src")).otherwise(col("AV_WIND_COMP"))) as "AV_WIND_COMP", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("MIN_FUEL_Src")).otherwise(col("MIN_FUEL"))) as "MIN_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("RAMP_FUEL_Src")).otherwise(col("RAMP_FUEL"))) as "RAMP_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CFP_EXTRA_Src")).otherwise(col("CFP_EXTRA"))) as "CFP_EXTRA", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CFP_USERUPDATE_Src")).otherwise(col("CFP_USERUPDATE"))) as "CFP_USERUPDATE", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALTN_FUEL_Src")).otherwise(col("ALTN_FUEL"))) as "ALTN_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FINAL_FUEL_Src")).otherwise(col("FINAL_FUEL"))) as "FINAL_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUEL1_Src")).otherwise(col("ADDNLFUEL1"))) as "ADDNLFUEL1", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUELREASON1_Src")).otherwise(col("ADDNLFUELREASON1"))) as "ADDNLFUELREASON1", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUEL2_Src")).otherwise(col("ADDNLFUEL2"))) as "ADDNLFUEL2", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUELREASON2_Src")).otherwise(col("ADDNLFUELREASON2"))) as "ADDNLFUELREASON2", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUEL3_Src")).otherwise(col("ADDNLFUEL3"))) as "ADDNLFUEL3", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUELREASON3_Src")).otherwise(col("ADDNLFUELREASON3"))) as "ADDNLFUELREASON3", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUEL4_Src")).otherwise(col("ADDNLFUEL4"))) as "ADDNLFUEL4", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADDNLFUELREASON4_Src")).otherwise(col("ADDNLFUELREASON4"))) as "ADDNLFUELREASON4", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TRIP_TIME_Src")).otherwise(col("PLN_TRIP_TIME"))) as "PLN_TRIP_TIME", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_BLK_TIME_Src")).otherwise(col("PLN_BLK_TIME"))) as "PLN_BLK_TIME", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_CONTINGENCY_FUEL_Src")).otherwise(col("PLN_CONTINGENCY_FUEL"))) as "PLN_CONTINGENCY_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_CONTINGENCY_USED_Src")).otherwise(col("ACT_CONTINGENCY_USED"))) as "ACT_CONTINGENCY_USED", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_MIN_FUEL_ON_ARV_Src")).otherwise(col("PLN_MIN_FUEL_ON_ARV"))) as "PLN_MIN_FUEL_ON_ARV", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TAXI_FUEL_OUT_Src")).otherwise(col("PLN_TAXI_FUEL_OUT"))) as "PLN_TAXI_FUEL_OUT", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_TAXI_FUEL_OUT_Src")).otherwise(col("ACT_TAXI_FUEL_OUT"))) as "ACT_TAXI_FUEL_OUT", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TAXI_FUEL_IN_Src")).otherwise(col("PLN_TAXI_FUEL_IN"))) as "PLN_TAXI_FUEL_IN", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_TAXI_FUEL_IN_Src")).otherwise(col("ACT_TAXI_FUEL_IN"))) as "ACT_TAXI_FUEL_IN", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TRIP_FUEL_Src")).otherwise(col("PLN_TRIP_FUEL"))) as "PLN_TRIP_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_TRIP_FUEL_Src")).otherwise(col("ACT_TRIP_FUEL"))) as "ACT_TRIP_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_BLK_FUEL_Src")).otherwise(col("PLN_BLK_FUEL"))) as "PLN_BLK_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_BLK_FUEL_Src")).otherwise(col("ACT_BLK_FUEL"))) as "ACT_BLK_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_ZFW_Src")).otherwise(col("PLN_ZFW"))) as "PLN_ZFW", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_ZFW_Src")).otherwise(col("ACT_ZFW"))) as "ACT_ZFW", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("TANKERING_STATUS_ID_Src")).otherwise(col("TANKERING_STATUS_ID"))) as "TANKERING_STATUS_ID", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("TANKERING_FUEL_Src")).otherwise(col("TANKERING_FUEL"))) as "TANKERING_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TAKE_OFF_WT_Src")).otherwise(col("PLN_TAKE_OFF_WT"))) as "PLN_TAKE_OFF_WT", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_TAKE_OFF_WT_Src")).otherwise(col("ACT_TAKE_OFF_WT"))) as "ACT_TAKE_OFF_WT", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TAKE_OFF_FUEL_Src")).otherwise(col("PLN_TAKE_OFF_FUEL"))) as "PLN_TAKE_OFF_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FUEL_OUT_Src")).otherwise(col("FUEL_OUT"))) as "FUEL_OUT", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FUEL_OFF_Src")).otherwise(col("FUEL_OFF"))) as "FUEL_OFF", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FUEL_ON_Src")).otherwise(col("FUEL_ON"))) as "FUEL_ON", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FUEL_IN_Src")).otherwise(col("FUEL_IN"))) as "FUEL_IN", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("EXT_FUEL_REASON_Src")).otherwise(col("EXT_FUEL_REASON"))) as "EXT_FUEL_REASON", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("REMARK_Src")).otherwise(col("REMARK"))) as "REMARK", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ZFW_CORRECTION_Src")).otherwise(col("ZFW_CORRECTION"))) as "ZFW_CORRECTION", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADJS_EXTRA_FUEL_Src")).otherwise(col("ADJS_EXTRA_FUEL"))) as "ADJS_EXTRA_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("EXCESS_ARV_FUEL_Src")).otherwise(col("EXCESS_ARV_FUEL"))) as "EXCESS_ARV_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ADJS_EX_ARV_FUEL_Src")).otherwise(col("ADJS_EX_ARV_FUEL"))) as "ADJS_EX_ARV_FUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("EXT_FUEL_PENALTY_Src")).otherwise(col("EXT_FUEL_PENALTY"))) as "EXT_FUEL_PENALTY", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FUEL_BURN_SAVED_Src")).otherwise(col("FUEL_BURN_SAVED"))) as "FUEL_BURN_SAVED", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("EXT_FUEL_CATEGORY_Src")).otherwise(col("EXT_FUEL_CATEGORY"))) as "EXT_FUEL_CATEGORY", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PCT_CONT_USED_Src")).otherwise(col("PCT_CONT_USED"))) as "PCT_CONT_USED", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("MODON_Src")).otherwise(col("MODON"))) as "MODON", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("MODBY_Src")).otherwise(col("MODBY"))) as "MODBY", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("EXTRA_FUEL_CATEFORIZATION_Src")).otherwise(col("EXTRA_FUEL_CATEFORIZATION"))) as "EXTRA_FUEL_CATEFORIZATION", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("WABI_TOF_Src")).otherwise(col("WABI_TOF"))) as "WABI_TOF", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("VERIFIED_Src")).otherwise(col("VERIFIED"))) as "VERIFIED", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CRZ_DEG_Src")).otherwise(col("CRZ_DEG"))) as "CRZ_DEG", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("COST_IDX_Src")).otherwise(col("COST_IDX"))) as "COST_IDX", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ISA_Src")).otherwise(col("ISA"))) as "ISA", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST1_Src")).otherwise(col("ALT_DEST1"))) as "ALT_DEST1", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST_RW1_Src")).otherwise(col("ALT_DEST_RW1"))) as "ALT_DEST_RW1", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DIST1_Src")).otherwise(col("ALT_DIST1"))) as "ALT_DIST1", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST2_Src")).otherwise(col("ALT_DEST2"))) as "ALT_DEST2", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST_RW2_Src")).otherwise(col("ALT_DEST_RW2"))) as "ALT_DEST_RW2", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DIST2_Src")).otherwise(col("ALT_DIST2"))) as "ALT_DIST2", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST3_Src")).otherwise(col("ALT_DEST3"))) as "ALT_DEST3", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST_RW3_Src")).otherwise(col("ALT_DEST_RW3"))) as "ALT_DEST_RW3", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DIST3_Src")).otherwise(col("ALT_DIST3"))) as "ALT_DIST3", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST4_Src")).otherwise(col("ALT_DEST4"))) as "ALT_DEST4", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DEST_RW4_Src")).otherwise(col("ALT_DEST_RW4"))) as "ALT_DEST_RW4", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ALT_DIST4_Src")).otherwise(col("ALT_DIST4"))) as "ALT_DIST4", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CRZ_FL_Src")).otherwise(col("CRZ_FL"))) as "CRZ_FL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CRZ_TEMP_Src")).otherwise(col("CRZ_TEMP"))) as "CRZ_TEMP", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("DOW_MIN_Src")).otherwise(col("DOW_MIN"))) as "DOW_MIN", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("DOW_MAX_Src")).otherwise(col("DOW_MAX"))) as "DOW_MAX", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("DOI_RANGE_MIN_Src")).otherwise(col("DOI_RANGE_MIN"))) as "DOI_RANGE_MIN", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("DOI_RANGE_MAX_Src")).otherwise(col("DOI_RANGE_MAX"))) as "DOI_RANGE_MAX", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ELWT_Src")).otherwise(col("ELWT"))) as "ELWT", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TAXI_OUT_TIME_Src")).otherwise(col("PLN_TAXI_OUT_TIME"))) as "PLN_TAXI_OUT_TIME", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_TAXI_OUT_TIME_Src")).otherwise(col("ACT_TAXI_OUT_TIME"))) as "ACT_TAXI_OUT_TIME", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PLN_TAXI_IN_TIME_Src")).otherwise(col("PLN_TAXI_IN_TIME"))) as "PLN_TAXI_IN_TIME", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("ACT_TAXI_IN_TIME_Src")).otherwise(col("ACT_TAXI_IN_TIME"))) as "ACT_TAXI_IN_TIME", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("FUELTD_GT_MINFUEL_Src")).otherwise(col("FUELTD_GT_MINFUEL"))) as "FUELTD_GT_MINFUEL", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("DUP_OR_NULL_PIC_FLAG_Src")).otherwise(col("DUP_OR_NULL_PIC_FLAG"))) as "DUP_OR_NULL_PIC_FLAG", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CARCODE_Src")).otherwise(col("CARCODE"))) as "CARCODE", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("PIC_MFP_Src")).otherwise(col("PIC_MFP"))) as "PIC_MFP", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("CAP_NAME_MFP_Src")).otherwise(col("CAP_NAME_MFP"))) as "CAP_NAME_MFP", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("MFP_FILE_PATH_Src")).otherwise(col("MFP_FILE_PATH"))) as "MFP_FILE_PATH", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("HELIX_UUID_Src")).otherwise(col("HELIX_UUID"))) as "HELIX_UUID", (when(((col("FLIGHTNO") === col("FLIGHTNO_Src")) && (col("FLIGHT_DATE") === col("FLIGHT_DATE_Src")) && (col("DEP_STN") === col("DEP_STN_Src")) && (col("ARV_STN") === col("ARV_STN_Src")) && (col("ACREG") === col("ACREG_Src"))), col("HELIX_TIMESTAMP_Src")).otherwise(col("HELIX_TIMESTAMP"))) as "HELIX_TIMESTAMP")
        */
        //read latest input data from decomposed data
        dfDedupDecomData = dedupdecompdata(incr_Input_path);
        //Union on Decomposed sorce and merge target data
        val dfUnion = unionByName(dfDedupDecomData, dfTgtSnap)

        //Drop Duplicates
        val dfDropDup = dfUnion.dropDuplicates;
         val dfDedupRes = dedupdfdata(dfDropDup);
        dfDedupRes.write.mode("overwrite").parquet(incr_Output_Path_Temp);
      } } catch {
          case e: Exception =>
            ///logger.info(" decompdataprocess Method - Error while writing data into HDFS: " + e);
            throw new Exception("decompdataprocess: Runtime issue while ingesting Merge data into  location")
        }

  }
  def dedupdecompdata(Path: String): DataFrame = {
    try {
      import sqlContext.implicits._
      val dfColsList = Seq("FLIGHTNO","FLIGHT_DATE","DEP_STN","ARV_STN","ACREG","AC_TYPE","PIC","PIC_USERUPDATE","GND_DIST","AIR_DIST","AV_WIND_COMP","MIN_FUEL","RAMP_FUEL","CFP_EXTRA","CFP_USERUPDATE","ALTN_FUEL","FINAL_FUEL","ADDNLFUEL1","ADDNLFUELREASON1","ADDNLFUEL2","ADDNLFUELREASON2","ADDNLFUEL3","ADDNLFUELREASON3","ADDNLFUEL4","ADDNLFUELREASON4","PLN_TRIP_TIME","PLN_BLK_TIME","PLN_CONTINGENCY_FUEL","ACT_CONTINGENCY_USED","PLN_MIN_FUEL_ON_ARV","PLN_TAXI_FUEL_OUT","ACT_TAXI_FUEL_OUT","PLN_TAXI_FUEL_IN","ACT_TAXI_FUEL_IN","PLN_TRIP_FUEL","ACT_TRIP_FUEL","PLN_BLK_FUEL","ACT_BLK_FUEL","PLN_ZFW","ACT_ZFW","TANKERING_STATUS_ID","TANKERING_FUEL","PLN_TAKE_OFF_WT","ACT_TAKE_OFF_WT","PLN_TAKE_OFF_FUEL","FUEL_OUT","FUEL_OFF","FUEL_ON","FUEL_IN","EXT_FUEL_REASON","REMARK","ZFW_CORRECTION","ADJS_EXTRA_FUEL","EXCESS_ARV_FUEL","ADJS_EX_ARV_FUEL","EXT_FUEL_PENALTY","FUEL_BURN_SAVED","EXT_FUEL_CATEGORY","PCT_CONT_USED","MODON","MODBY","EXTRA_FUEL_CATEFORIZATION","WABI_TOF","VERIFIED","CRZ_DEG","COST_IDX","ISA","ALT_DEST1","ALT_DEST_RW1","ALT_DIST1","ALT_DEST2","ALT_DEST_RW2","ALT_DIST2","ALT_DEST3","ALT_DEST_RW3","ALT_DIST3","ALT_DEST4","ALT_DEST_RW4","ALT_DIST4","CRZ_FL","CRZ_TEMP","DOW_MIN","DOW_MAX","DOI_RANGE_MIN","DOI_RANGE_MAX","ELWT","PLN_TAXI_OUT_TIME","ACT_TAXI_OUT_TIME","PLN_TAXI_IN_TIME","ACT_TAXI_IN_TIME","FUELTD_GT_MINFUEL","DUP_OR_NULL_PIC_FLAG","CARCODE","PIC_MFP","CAP_NAME_MFP","MFP_FILE_PATH","HELIX_UUID","HELIX_TIMESTAMP");
      val df = sqlContext.read.format("com.databricks.spark.avro").load(Path);
      val w = Window.partitionBy($"FLIGHTNO", $"FLIGHT_DATE", $"DEP_STN", $"ARV_STN", $"ACREG").orderBy($"MODON".desc);
      val dfDropDup = df.dropDuplicates;
      val dfRn = dfDropDup.withColumn("rn", row_number.over(w));
      val dfFilReq = dfRn.filter($"rn" === 1);
      val dfReq = select(dfFilReq,sqlContext,dfColsList)
      dfReq;
    } catch {
      case e: Exception =>
        //logger.info(" dedupdecompdata Method - Error while writing data into HDFS: " + e);
        throw new Exception("dedupdecompdata: Runtime issue while executing Deduping merging data")
    }
  }
  //this is to perform union on two data frames
  def unionByName(a: DataFrame, b: DataFrame): DataFrame = {
    val columns = a.columns.toSet.intersect(b.columns.toSet).map(col).toSeq
    println(columns)
    a.select(columns: _*).unionAll(b.select(columns: _*))
  }
  
  //to perform dedup logic on the input DF
  def dedupdfdata(df: DataFrame): DataFrame = {
    try {
      import sqlContext.implicits._
      val dfColsList = Seq("FLIGHTNO","FLIGHT_DATE","DEP_STN","ARV_STN","ACREG","AC_TYPE","PIC","PIC_USERUPDATE","GND_DIST","AIR_DIST","AV_WIND_COMP","MIN_FUEL","RAMP_FUEL","CFP_EXTRA","CFP_USERUPDATE","ALTN_FUEL","FINAL_FUEL","ADDNLFUEL1","ADDNLFUELREASON1","ADDNLFUEL2","ADDNLFUELREASON2","ADDNLFUEL3","ADDNLFUELREASON3","ADDNLFUEL4","ADDNLFUELREASON4","PLN_TRIP_TIME","PLN_BLK_TIME","PLN_CONTINGENCY_FUEL","ACT_CONTINGENCY_USED","PLN_MIN_FUEL_ON_ARV","PLN_TAXI_FUEL_OUT","ACT_TAXI_FUEL_OUT","PLN_TAXI_FUEL_IN","ACT_TAXI_FUEL_IN","PLN_TRIP_FUEL","ACT_TRIP_FUEL","PLN_BLK_FUEL","ACT_BLK_FUEL","PLN_ZFW","ACT_ZFW","TANKERING_STATUS_ID","TANKERING_FUEL","PLN_TAKE_OFF_WT","ACT_TAKE_OFF_WT","PLN_TAKE_OFF_FUEL","FUEL_OUT","FUEL_OFF","FUEL_ON","FUEL_IN","EXT_FUEL_REASON","REMARK","ZFW_CORRECTION","ADJS_EXTRA_FUEL","EXCESS_ARV_FUEL","ADJS_EX_ARV_FUEL","EXT_FUEL_PENALTY","FUEL_BURN_SAVED","EXT_FUEL_CATEGORY","PCT_CONT_USED","MODON","MODBY","EXTRA_FUEL_CATEFORIZATION","WABI_TOF","VERIFIED","CRZ_DEG","COST_IDX","ISA","ALT_DEST1","ALT_DEST_RW1","ALT_DIST1","ALT_DEST2","ALT_DEST_RW2","ALT_DIST2","ALT_DEST3","ALT_DEST_RW3","ALT_DIST3","ALT_DEST4","ALT_DEST_RW4","ALT_DIST4","CRZ_FL","CRZ_TEMP","DOW_MIN","DOW_MAX","DOI_RANGE_MIN","DOI_RANGE_MAX","ELWT","PLN_TAXI_OUT_TIME","ACT_TAXI_OUT_TIME","PLN_TAXI_IN_TIME","ACT_TAXI_IN_TIME","FUELTD_GT_MINFUEL","DUP_OR_NULL_PIC_FLAG","CARCODE","PIC_MFP","CAP_NAME_MFP","MFP_FILE_PATH","HELIX_UUID","HELIX_TIMESTAMP");
      //val df = sqlContext.read.format("com.databricks.spark.avro").load(Path);
      val w = Window.partitionBy($"FLIGHTNO", $"FLIGHT_DATE", $"DEP_STN", $"ARV_STN", $"ACREG").orderBy($"MODON".desc);
      val dfDropDup = df.dropDuplicates;
      val dfRn = dfDropDup.withColumn("rn", row_number.over(w));
      val dfFilReq = dfRn.filter($"rn" === 1);
      val dfReq = select(dfFilReq, sqlContext, dfColsList)
      dfReq;
    } catch {
      case e: Exception =>
        //logger.info(" dedupdecompdata Method - Error while writing data into HDFS: " + e);
        throw new Exception("dedupdecompdata: Runtime issue while executing Deduping merging data")
    }
  }

}